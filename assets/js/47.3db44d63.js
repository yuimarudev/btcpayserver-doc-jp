(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{570:function(e,v,r){e.exports=r.p+"assets/img/btcpayformbuilder1.c4b78601.png"},571:function(e,v,r){e.exports=r.p+"assets/img/btcpayformbuilder2.aa5f358e.png"},572:function(e,v,r){e.exports=r.p+"assets/img/btcpayformbuilder2-1.762fc637.png"},573:function(e,v,r){e.exports=r.p+"assets/img/btcpayformbuilder2-2.265e8675.png"},574:function(e,v,r){e.exports=r.p+"assets/img/btcpayformbuilder2-3.700def4f.png"},575:function(e,v,r){e.exports=r.p+"assets/img/btcpayformbuilder2-4.d3dbe396.png"},576:function(e,v,r){e.exports=r.p+"assets/img/btcpayformbuilder3.9c86be51.png"},986:function(e,v,r){"use strict";r.r(v);var _=r(17),t=Object(_.a)({},(function(){var e=this,v=e._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("h1",{attrs:{id:"フォーム"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#フォーム"}},[e._v("#")]),e._v(" フォーム")]),e._v(" "),v("p",[e._v("BTCPay Server のフォームビルダーを使うと、顧客から特定の情報を収集できます。")]),e._v(" "),v("p",[e._v("これらのフォームは要件に合わせて完全にカスタマイズできます。\nこの入門ではビジュアルフォームビルダーを扱います。より高度な設定を行いたい場合は、ドキュメントの "),v("RouterLink",{attrs:{to:"/AdvancedForms/"}},[e._v("Advanced Forms")]),e._v(" セクションをご覧ください。")],1),e._v(" "),v("h2",{attrs:{id:"ストア最初のカスタムフォームを設定する"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ストア最初のカスタムフォームを設定する"}},[e._v("#")]),e._v(" ストア最初のカスタムフォームを設定する")]),e._v(" "),v("p",[e._v("この例では、あらかじめ用意されている標準フォームを作成します。\n"),v("code",[e._v("Store Settings")]),e._v(" をクリックすると、ストア設定の最後のタブに "),v("code",[e._v("Forms")]),e._v(" があります。"),v("code",[e._v("Forms")]),e._v(" をクリックして最初のカスタムフォームを作成します。")]),e._v(" "),v("figure",[v("img",{attrs:{src:r(570),alt:"BTCPay Server formbuilder - settings",title:"BTCPay Server formbuilder - settings"}})]),e._v(" "),v("p",[e._v("カスタムフォームページで "),v("code",[e._v("Create New Form")]),e._v(" をクリックします。\n"),v("code",[e._v("Email")]),e._v(" と "),v("code",[e._v("Address")]),e._v(" の2つのサンプルが用意されています。\nこの例では "),v("code",[e._v("Address")]),e._v(" フォームをクリックします。")]),e._v(" "),v("figure",[v("img",{attrs:{src:r(571),alt:"BTCPay Server formbuilder - Create new form",title:"BTCPay Server formbuilder - Create new form"}})]),e._v(" "),v("p",[e._v("これで、BTCPay Server が用意したフィールドをドラッグして配置できます。\n順序を入れ替えたり、フォーム下部の "),v("code",[e._v("Add form element")]),e._v(" をクリックして新しいフィールドを作成できます。")]),e._v(" "),v("h2",{attrs:{id:"カスタムフォームを作成する"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#カスタムフォームを作成する"}},[e._v("#")]),e._v(" カスタムフォームを作成する")]),e._v(" "),v("p",[e._v("別のユースケースがあるかもしれません。たとえばレストランを運営している場合、テーブル番号、配膳時の呼び方、アレルギー、特別な要望などを把握したいことがあります。")]),e._v(" "),v("p",[e._v("次の手順でカスタムフォームを作成してみましょう。\n前の例と同じく "),v("code",[e._v("Store settings -> Forms")]),e._v(" から開始します。")]),e._v(" "),v("p",[e._v("右上の "),v("code",[e._v("create form")]),e._v(" をクリックします。\nまず名前を付けます。この例では "),v("code",[e._v("Restaurant")]),e._v(" を使います。\n前回と違い、今回は生成された空のフィールドから開始します。")]),e._v(" "),v("figure",[v("img",{attrs:{src:r(572),alt:"BTCPay Server formbuilder - Create new form",title:"BTCPay Server formbuilder - Create new form"}})]),e._v(" "),v("ol",[v("li",[e._v("最初のフィールド名を "),v("code",[e._v("Table number")]),e._v(" にします。")]),e._v(" "),v("li",[e._v("フィールドの "),v("code",[e._v("Type")]),e._v(" を定義します。ここではテキストまたは数値が必要なので、ドロップダウンから "),v("code",[e._v("Number")]),e._v(" を選択します。")])]),e._v(" "),v("figure",[v("img",{attrs:{src:r(573),alt:"BTCPay Server formbuilder - Create new form",title:"BTCPay Server formbuilder - Create new form"}})]),e._v(" "),v("ol",{attrs:{start:"3"}},[v("li",[e._v("このフィールドが顧客に表示されるラベルを設定します。この例では "),v("code",[e._v("Table Number")]),e._v(" にします。")]),e._v(" "),v("li",[e._v("フィールド名は一貫性のため、前の項目と同じ "),v("code",[e._v("Table Number")]),e._v(" を使います。")]),e._v(" "),v("li",[v("code",[e._v("Default value")]),e._v(" は設定できますが、この例では空のままにします。")]),e._v(" "),v("li",[v("code",[e._v("Helper Text")]),e._v(" は、作成中のフィールドの下に表示される補助テキストで、顧客に何を入力してほしいかを示します。")]),e._v(" "),v("li",[e._v("最後に2つのパラメータを設定できます。1つは必須入力にする設定で、この例では有効にします。もう1つは "),v("code",[e._v("Constant")]),e._v(" で、これを有効にするとユーザーが変更できないため、この例では使用しません。")])]),e._v(" "),v("figure",[v("img",{attrs:{src:r(574),alt:"BTCPay Server formbuilder - Create new form",title:"BTCPay Server formbuilder - Create new form"}})]),e._v(" "),v("p",[e._v("フィールドのパラメータを入力すると、エディタ左側に顧客操作時の表示と動作が反映されます。")]),e._v(" "),v("figure",[v("img",{attrs:{src:r(575),alt:"BTCPay Server formbuilder - Create new form",title:"BTCPay Server formbuilder - Create new form"}})]),e._v(" "),v("p",[e._v("最初のフィールドが完成したら、下にある "),v("code",[e._v("+ Add form element")]),e._v(" をクリックして必要な残りのフィールドを作成できます。すべて作成したら画面右上の "),v("code",[e._v("Save")]),e._v(" をクリックして完了です。")]),e._v(" "),v("figure",[v("img",{attrs:{src:r(576),alt:"BTCPay Server formbuilder - Create new form",title:"BTCPay Server formbuilder - Create new form"}})]),e._v(" "),v("p",[v("code",[e._v("Form Builder")]),e._v(" を使うと、柔軟かつ簡単にカスタムフォームを作成できます。さらに細かくカスタマイズしたい場合は、冒頭で触れた "),v("RouterLink",{attrs:{to:"/AdvancedForms/"}},[e._v("Advanced Forms")]),e._v(" を参照し、フォームビルダーの "),v("code",[e._v("Code")]),e._v(" タブで生成される JSON を確認してください。")],1),e._v(" "),v("h2",{attrs:{id:"公開フォーム"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#公開フォーム"}},[e._v("#")]),e._v(" 公開フォーム")]),e._v(" "),v("p",[v("code",[e._v("Allow form for public use")]),e._v(" を有効にすると、フォームを共有 URL として利用でき、ユーザーがフォーム入力後に請求書が生成されます。")]),e._v(" "),v("p",[e._v('デフォルトでは請求書通貨はストアの既定通貨、金額は "any" に設定されています。')]),e._v(" "),v("p",[e._v("特定の名前のフィールドを作成することで、事前設定済みの通貨と金額をフォームに持たせることができます。")]),e._v(" "),v("ul",[v("li",[e._v("Invoice currency: フィールド名を "),v("code",[e._v("invoice_currency")]),e._v(" にします。値が有効な通貨コードを返すようにしてください。")]),e._v(" "),v("li",[e._v("Invoice amount: フィールド名を "),v("code",[e._v("invoice_amount")]),e._v(" にします。値が数値を返すようにしてください。")])]),e._v(" "),v("p",[e._v("これらのフィールドは "),v("code",[e._v("hidden")]),e._v(" タイプにするとユーザーに表示しないようにできます。さらにユーザーに値を変更させたくない場合は、"),v("code",[e._v("Constant")]),e._v(" を有効化してください。")]),e._v(" "),v("p",[e._v("これは Pay Button の代替として利用でき、金額や通貨などの請求パラメータを固定できる利点があります。")]),e._v(" "),v("h2",{attrs:{id:"ユーザー入力に応じて請求額を調整する"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ユーザー入力に応じて請求額を調整する"}},[e._v("#")]),e._v(" ユーザー入力に応じて請求額を調整する")]),e._v(" "),v("p",[e._v("現代の多くの EC シナリオでは、配送方法、国、プロモーションコードなどのユーザー入力に応じて請求額を変更する必要があります。")]),e._v(" "),v("p",[e._v("BTCPay Server v1.11.0 以降、この機能がフォームに搭載されています。フィールド名が "),v("code",[e._v("invoice_amount_adjustment")]),e._v("（v1.11 以降対応）または "),v("code",[e._v("invoice_amount_multiply_adjustment")]),e._v("（v1.12 以降対応）で始まり、値が有効な数値であれば、請求額が自動的に調整されます。")]),e._v(" "),v("p",[e._v("この機能は現在、公開フォーム利用時と Point of Sale プラグインで動作します。\n詳細は Advanced Forms ガイドの "),v("RouterLink",{attrs:{to:"/AdvancedForms/#mirror-fields"}},[e._v("Mirror Fields")]),e._v(" セクションを参照してください。")],1),e._v(" "),v("h3",{attrs:{id:"配送方法に応じて追加料金を請求する"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#配送方法に応じて追加料金を請求する"}},[e._v("#")]),e._v(" 配送方法に応じて追加料金を請求する")]),e._v(" "),v("p",[e._v('"select" タイプのフィールドを作成し、名前を '),v("code",[e._v("invoice_amount_adjustment_shipping_method")]),e._v(" にします。利用可能な配送方法に対応する選択肢を作成します。ここでは "),v("code",[e._v("DHL")]),e._v(" の値を "),v("code",[e._v("10")]),e._v("、"),v("code",[e._v("Fedex")]),e._v(" の値を "),v("code",[e._v("20")]),e._v(" とします。ユーザーがいずれかを選ぶと、請求額はそれぞれ 10 または 20 調整されます。")]),e._v(" "),v("p",[e._v("注: これは単純化した例です。請求額自体は正しく調整されますが、作成された請求書内に選択された配送方法は表示されません。これを実現するには "),v("code",[e._v("Mirror")]),e._v(" フィールドを使う必要があります。")]),e._v(" "),v("p",[e._v("ユーザーが選択した配送方法を保存するには、代わりに次のように設定します。")]),e._v(" "),v("ul",[v("li",[e._v('"select" タイプのフィールドを作成し、名前を '),v("code",[e._v("shipping_method")]),e._v(" にします。配送方法に対応する選択肢を定義します。ここでは "),v("code",[e._v("DHL")]),e._v(" の値を "),v("code",[e._v("dhl")]),e._v("、"),v("code",[e._v("Fedex")]),e._v(" の値を "),v("code",[e._v("fedex")]),e._v(" とします。")]),e._v(" "),v("li",[e._v('"mirror" タイプのフィールドを作成し、名前を '),v("code",[e._v("invoice_amount_adjustment_shipping_method")]),e._v(" にします。"),v("code",[e._v("Field to mirror")]),e._v(" で "),v("code",[e._v("shipping_method")]),e._v(" フィールドを選択し、"),v("code",[e._v("Value Mapper")]),e._v(" に "),v("code",[e._v("shipping_method")]),e._v(" の各選択肢と課金額を設定します。")])]),e._v(" "),v("h3",{attrs:{id:"プロモーションコード"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#プロモーションコード"}},[e._v("#")]),e._v(" プロモーションコード")]),e._v(" "),v("ul",[v("li",[e._v('"text" タイプのフィールドを作成し、名前を '),v("code",[e._v("promoCode")]),e._v(" にします。")]),e._v(" "),v("li",[e._v('"mirror" タイプのフィールドを作成し、名前を '),v("code",[e._v("invoice_amount_adjustment_promo")]),e._v(" にします。"),v("code",[e._v("Field to mirror")]),e._v(" で "),v("code",[e._v("promoCode")]),e._v(" フィールドを選択し、"),v("code",[e._v("Value Mapper")]),e._v(" に利用可能なプロモーションコードを作成します。例えば "),v("code",[e._v("Original Value")]),e._v(" を "),v("code",[e._v("chocolate")]),e._v("、"),v("code",[e._v("Mapped Value")]),e._v(" を "),v("code",[e._v("-5")]),e._v(" に設定します。")])]),e._v(" "),v("p",[e._v("ユーザーがプロモーションコード欄に "),v("code",[e._v("chocolate")]),e._v(" と入力すると、請求額が -5 調整されます。")]),e._v(" "),v("h3",{attrs:{id:"レシートにユーザー入力を表示する"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#レシートにユーザー入力を表示する"}},[e._v("#")]),e._v(" レシートにユーザー入力を表示する")]),e._v(" "),v("p",[e._v("デフォルトでは、ユーザー入力は請求書レシートに表示されません。表示するには、各フィールドに対してマッピングを作成する必要があります。")]),e._v(" "),v("ul",[v("li",[v("code",[e._v("fieldset")]),e._v(" タイプのフィールドを作成し、名前を "),v("code",[e._v("receiptData")]),e._v(" にします。")]),e._v(" "),v("li",[e._v("レシートに表示したい各フィールドについて、"),v("code",[e._v("mirror")]),e._v(" タイプのフィールドを作成し、"),v("code",[e._v("Field to mirror")]),e._v(" にレシートへコピーしたいフィールドを設定します。")])])])}),[],!1,null,null,null);v.default=t.exports}}]);